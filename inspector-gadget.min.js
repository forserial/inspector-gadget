"use strict";angular.module("swd.inspector-gadget",[]),angular.module("swd.inspector-gadget").service("intPopover",function(){this.bootstrap=function(elm,config){elm.popover(config)},this.show=function(elm){return elm.popover("show")},this.hide=function(elm){return elm.popover("hide")}}),angular.module("swd.inspector-gadget").directive("inspectorGadget",function($compile,$document,intPopover){var doc=$document[0],body=$document.find("body"),getThenMute=function(element,selector,tag){var childElm=element.find(selector);if(1!==childElm.length){var errStr="inspector-gadget expecting exactly one "+selector+" 0 or >1 found";throw console.error(errStr),errStr}if(tag){var tagDiv=doc.createElement("div");tagDiv.setAttribute("data-inspector-gadget-tag",tag),tagDiv.setAttribute("style","display: none"),childElm[0].appendChild(tagDiv)}var childHtml=childElm[0].innerHTML;return childElm[0].hidden=!0,childHtml},collectPopoverAttrArgs=function(attrs){var bootstrArgs={};return angular.forEach(attrs,function(attrValue,attrName){("placement"===attrName||"animation"===attrName||"delay"===attrName||"container"===attrName||"viewport"===attrName)&&(bootstrArgs[attrName]=attrValue)}),bootstrArgs},getPopoverContainer=function(popoverId){var elm=body.find('div[data-inspector-gadget-tag="'+popoverId+'"]'),popover=elm.parent().parent();return popover},uniqueDirective=1;return{restrict:"E",transclude:!0,template:'<div style="display: inline-block" class="anchored_div" ng-transclude></div>',link:function(scope,element,attrs){var anchoredDiv=element.find(".anchored_div"),myPopoverId=uniqueDirective++,titleHtml=getThenMute(element,"inspector-title",myPopoverId),contentHtml=getThenMute(element,"inspector-content"),popConfig=collectPopoverAttrArgs(attrs),timeoutObj=null;popConfig.html=!0,popConfig.title=function(){return titleHtml},popConfig.content=function(){return contentHtml},popConfig.trigger="manual",anchoredDiv.mouseenter(function(){intPopover.show(anchoredDiv);var popCont=getPopoverContainer(myPopoverId);console.log("compiling popover content: "+popCont.length+" timer:"+scope.timer),$compile(popCont.contents())(scope),scope.$apply()}),anchoredDiv.mouseleave(function(){console.log("mouseleave");var popCont=getPopoverContainer(myPopoverId);console.log("LEAVE LINK");var hoveringPopover=!1;popCont.mouseenter(function(){console.log("enter pop"),hoveringPopover=!0}),popCont.mouseleave(function(){console.log("leave pop"),hoveringPopover=!1});var hidePop=function(){hoveringPopover?timeoutObj=setTimeout(hidePop,300):intPopover.hide(anchoredDiv)};timeoutObj=setTimeout(hidePop,300)}),intPopover.bootstrap(anchoredDiv,popConfig),console.log("popover created: "+anchoredDiv.html())}}});